2024-10-25 12:36:27.307 [main] TRACE UserController - Entering addRole method in UserController class
2024-10-25 12:36:27.338 [main] INFO  UserController - Adding role to user with id: 1
2024-10-25 12:36:27.338 [main] INFO  UserController - Role added to user with id 1 successfully
2024-10-25 12:36:27.338 [main] TRACE UserController - Exiting addRole method in UserController class
2024-10-25 12:36:27.763 [main] TRACE UserController - Entering getUsernameByEmail method in UserController class
2024-10-25 12:36:27.763 [main] INFO  UserController - Fetching username by email: test@example.com
2024-10-25 12:36:27.873 [main] TRACE UserController - Exiting getUsernameByEmail method in UserController class
2024-10-25 12:36:27.888 [main] TRACE UserController - Entering getCurrentUser method in UserController class
2024-10-25 12:36:27.888 [main] INFO  UserController - Fetching current user by username: testUser
2024-10-25 12:36:27.888 [main] INFO  UserController - Current user retrieved successfully
2024-10-25 12:36:27.888 [main] TRACE UserController - Exiting getCurrentUser method in UserController class
2024-10-25 12:36:27.888 [main] TRACE UserController - Entering updateUser method in UserController class
2024-10-25 12:36:27.888 [main] INFO  UserController - Updating user with details: UpdateUserRequest(id=null, firstName=null, lastName=null, username=null, email=null, gender=null)
2024-10-25 12:36:27.888 [main] INFO  UserController - User updated successfully
2024-10-25 12:36:27.888 [main] TRACE UserController - Exiting updateUser method in UserController class
2024-10-25 12:36:27.904 [main] TRACE UserController - Entering restoreUser method in UserController class
2024-10-25 12:36:27.904 [main] INFO  UserController - Restoring user with id: 1
2024-10-25 12:36:27.904 [main] INFO  UserController - User with id 1 restored successfully
2024-10-25 12:36:27.904 [main] TRACE UserController - Exiting restoreUser method in UserController class
2024-10-25 12:36:27.904 [main] TRACE UserController - Entering getAllUsersFilteredAndSorted method in UserController class
2024-10-25 12:36:27.904 [main] INFO  UserController - Fetching users with filters - page: 0, size: 3, sortBy: id, direction: ASC, firstName: null, lastName: null, username: null, hospitalId: null, email: null, role: null, gender: null, deleted: null
2024-10-25 12:36:27.904 [main] INFO  UserController - Users filtered and sorted fetched successfully
2024-10-25 12:36:27.904 [main] TRACE UserController - Exiting getAllUsersFilteredAndSorted method in UserController class
2024-10-25 12:36:27.904 [main] TRACE UserController - Entering removeRole method in UserController class
2024-10-25 12:36:27.904 [main] INFO  UserController - Removing role from user with id: 1
2024-10-25 12:36:27.904 [main] INFO  UserController - Role removed from user with id 1 successfully
2024-10-25 12:36:27.904 [main] TRACE UserController - Exiting removeRole method in UserController class
2024-10-25 12:36:27.904 [main] TRACE UserController - Entering createUser method in UserController class
2024-10-25 12:36:27.920 [main] INFO  UserController - Creating a new user with details: CreateUserRequest(firstName=null, lastName=null, username=null, email=null, password=null, roles=null, gender=null)
2024-10-25 12:36:27.920 [main] INFO  UserController - User created successfully
2024-10-25 12:36:27.920 [main] TRACE UserController - Exiting createUser method in UserController class
2024-10-25 12:36:27.920 [main] TRACE UserController - Entering deleteUser method in UserController class
2024-10-25 12:36:27.920 [main] INFO  UserController - Deleting user with id: 1
2024-10-25 12:36:27.920 [main] INFO  UserController - User with id 1 deleted successfully
2024-10-25 12:36:27.920 [main] TRACE UserController - Exiting deleteUser method in UserController class
2024-10-25 12:36:27.920 [main] TRACE UserController - Entering getUserById method in UserController class
2024-10-25 12:36:27.920 [main] INFO  UserController - Fetching user by id: 1
2024-10-25 12:36:27.920 [main] INFO  UserController - User with id 1 retrieved successfully
2024-10-25 12:36:27.920 [main] TRACE UserController - Exiting getUserById method in UserController class
2024-10-25 12:36:27.935 [main] TRACE UserController - Entering updateCurrentUser method in UserController class
2024-10-25 12:36:27.935 [main] INFO  UserController - Updating current user with username: testUser
2024-10-25 12:36:27.935 [main] INFO  UserController - Current user updated successfully
2024-10-25 12:36:27.935 [main] TRACE UserController - Exiting updateCurrentUser method in UserController class
2024-10-25 12:36:28.815 [main] TRACE UserServiceImpl - Entering updateCurrentUser method in UserServiceImpl
2024-10-25 12:36:28.815 [main] INFO  UserServiceImpl - Updating current user: testUser
2024-10-25 12:36:28.815 [main] DEBUG UserServiceImpl - Updated first name for user: com.lab.backend.usermanagement.entity.User@328e687e
2024-10-25 12:36:28.815 [main] DEBUG UserServiceImpl - Saved updated user: com.lab.backend.usermanagement.entity.User@328e687e
2024-10-25 12:36:28.815 [main] TRACE UserServiceImpl - Exiting updateCurrentUser method in UserServiceImpl
2024-10-25 12:36:28.846 [main] TRACE UserServiceImpl - Entering getAllUsersFilteredAndSorted method in UserServiceImpl
2024-10-25 12:36:28.846 [main] INFO  UserServiceImpl - Fetching users with filters: page=0, size=10, sortBy=username, direction=ASC
2024-10-25 12:36:28.941 [main] DEBUG UserServiceImpl - Fetched 1 users
2024-10-25 12:36:28.941 [main] TRACE UserServiceImpl - Exiting getAllUsersFilteredAndSorted method in UserServiceImpl
2024-10-25 12:36:28.973 [main] TRACE UserServiceImpl - Entering updateUser method in UserServiceImpl
2024-10-25 12:36:28.973 [main] DEBUG UserServiceImpl - Updating user with id: 1
2024-10-25 12:36:28.973 [main] ERROR UserServiceImpl - User doesn't exist with id 1
2024-10-25 12:36:28.973 [main] TRACE UserServiceImpl - Entering createUser method in UserServiceImpl
2024-10-25 12:36:28.973 [main] DEBUG UserServiceImpl - Creating user with username: newUser
2024-10-25 12:36:29.019 [main] INFO  UserServiceImpl - Sent create message to RabbitMQ for user: newUser
2024-10-25 12:36:29.019 [main] INFO  UserServiceImpl - User created successfully: newUser
2024-10-25 12:36:29.019 [main] TRACE UserServiceImpl - Exiting createUser method in UserServiceImpl
2024-10-25 12:36:29.035 [main] TRACE UserServiceImpl - Entering getUsernameByEmail method in UserServiceImpl
2024-10-25 12:36:29.035 [main] INFO  UserServiceImpl - Fetching username by email: test@example.com
2024-10-25 12:36:29.035 [main] DEBUG UserServiceImpl - Found username: testUser
2024-10-25 12:36:29.035 [main] TRACE UserServiceImpl - Exiting getUsernameByEmail method in UserServiceImpl
2024-10-25 12:36:29.035 [main] TRACE UserServiceImpl - Entering createUser method in UserServiceImpl
2024-10-25 12:36:29.035 [main] DEBUG UserServiceImpl - Creating user with username: null
2024-10-25 12:36:29.035 [main] ERROR UserServiceImpl - Email 'existingEmail@example.com' is already taken
2024-10-25 12:36:29.051 [main] TRACE UserServiceImpl - Entering getUserById method in UserServiceImpl
2024-10-25 12:36:29.051 [main] INFO  UserServiceImpl - Fetching user by ID: 1
2024-10-25 12:36:29.051 [main] DEBUG UserServiceImpl - Fetched user: GetUserResponse(id=null, firstName=null, lastName=null, username=testUser, hospitalId=null, email=null, roles=null, gender=null)
2024-10-25 12:36:29.051 [main] TRACE UserServiceImpl - Exiting getUserById method in UserServiceImpl
2024-10-25 12:36:29.066 [main] TRACE UserServiceImpl - Entering getCurrentUser method in UserServiceImpl
2024-10-25 12:36:29.066 [main] INFO  UserServiceImpl - Fetching current user by username: testUser
2024-10-25 12:36:29.066 [main] DEBUG UserServiceImpl - Fetched current user: GetUserResponse(id=null, firstName=null, lastName=null, username=testUser, hospitalId=null, email=null, roles=null, gender=null)
2024-10-25 12:36:29.066 [main] TRACE UserServiceImpl - Exiting getCurrentUser method in UserServiceImpl
2024-10-25 12:36:29.066 [main] TRACE UserServiceImpl - Entering updateUser method in UserServiceImpl
2024-10-25 12:36:29.066 [main] DEBUG UserServiceImpl - Updating user with id: null
2024-10-25 12:36:29.066 [main] ERROR UserServiceImpl - Id must not be null
2024-10-25 12:36:29.084 [main] TRACE UserServiceImpl - Entering restoreUser method in UserServiceImpl
2024-10-25 12:36:29.084 [main] DEBUG UserServiceImpl - Restoring user with id: 1
2024-10-25 12:36:29.084 [main] INFO  UserServiceImpl - Sent restore message to RabbitMQ for user: userToRestore
2024-10-25 12:36:29.084 [main] INFO  UserServiceImpl - User restored successfully: userToRestore
2024-10-25 12:36:29.084 [main] TRACE UserServiceImpl - Exiting restoreUser method in UserServiceImpl
2024-10-25 12:36:29.098 [main] TRACE UserServiceImpl - Entering getUserById method in UserServiceImpl
2024-10-25 12:36:29.098 [main] INFO  UserServiceImpl - Fetching user by ID: 1
2024-10-25 12:36:29.098 [main] ERROR UserServiceImpl - User not found with ID: 1
2024-10-25 12:36:29.098 [main] TRACE UserServiceImpl - Entering updateUser method in UserServiceImpl
2024-10-25 12:36:29.098 [main] DEBUG UserServiceImpl - Updating user with id: 1
2024-10-25 12:36:29.098 [main] ERROR UserServiceImpl - Email is already taken newEmail@example.com
2024-10-25 12:36:29.114 [main] TRACE UserServiceImpl - Entering removeRole method in UserServiceImpl
2024-10-25 12:36:29.114 [main] INFO  UserServiceImpl - Removing role 'ADMIN' from user with id '1'
2024-10-25 12:36:29.114 [main] INFO  UserServiceImpl - Successfully sent remove role message for user 'existingUser'
2024-10-25 12:36:29.114 [main] INFO  UserServiceImpl - Role 'ADMIN' removed successfully from user 'existingUser'
2024-10-25 12:36:29.114 [main] TRACE UserServiceImpl - Exiting removeRole method in UserServiceImpl
2024-10-25 12:36:29.114 [main] TRACE UserServiceImpl - Entering addRole method in UserServiceImpl
2024-10-25 12:36:29.114 [main] INFO  UserServiceImpl - Adding role 'ADMIN' to user with id '1'
2024-10-25 12:36:29.114 [main] ERROR UserServiceImpl - User not found with id '1'
2024-10-25 12:36:29.129 [main] TRACE UserServiceImpl - Entering addRole method in UserServiceImpl
2024-10-25 12:36:29.129 [main] INFO  UserServiceImpl - Adding role 'ADMIN' to user with id '1'
2024-10-25 12:36:29.129 [main] ERROR UserServiceImpl - User 'existingUser' already has this role: 'ADMIN'
2024-10-25 12:36:29.129 [main] TRACE UserServiceImpl - Entering removeRole method in UserServiceImpl
2024-10-25 12:36:29.129 [main] INFO  UserServiceImpl - Removing role 'ADMIN' from user with id '1'
2024-10-25 12:36:29.129 [main] ERROR UserServiceImpl - Cannot remove role. User 'existingUser' must have at least one role
2024-10-25 12:36:29.145 [main] TRACE UserServiceImpl - Entering removeRole method in UserServiceImpl
2024-10-25 12:36:29.145 [main] INFO  UserServiceImpl - Removing role 'ADMIN' from user with id '1'
2024-10-25 12:36:29.145 [main] ERROR UserServiceImpl - User not found with id: '1'
2024-10-25 12:36:29.161 [main] TRACE UserServiceImpl - Entering restoreUser method in UserServiceImpl
2024-10-25 12:36:29.161 [main] DEBUG UserServiceImpl - Restoring user with id: 1
2024-10-25 12:36:29.161 [main] ERROR UserServiceImpl - User does not exist with id 1
2024-10-25 12:36:29.161 [main] TRACE UserServiceImpl - Entering getUsernameByEmail method in UserServiceImpl
2024-10-25 12:36:29.161 [main] INFO  UserServiceImpl - Fetching username by email: test@example.com
2024-10-25 12:36:29.161 [main] ERROR UserServiceImpl - No users registered to this email address: test@example.com
2024-10-25 12:36:29.161 [main] TRACE UserServiceImpl - Entering updateUser method in UserServiceImpl
2024-10-25 12:36:29.161 [main] DEBUG UserServiceImpl - Updating user with id: 1
2024-10-25 12:36:29.176 [main] ERROR UserServiceImpl - Username is taken newUsername
2024-10-25 12:36:29.176 [main] TRACE UserServiceImpl - Entering deleteUser method in UserServiceImpl
2024-10-25 12:36:29.176 [main] DEBUG UserServiceImpl - Deleting user with id: 1
2024-10-25 12:36:29.176 [main] ERROR UserServiceImpl - User doesn't exist with id: 1
2024-10-25 12:36:29.176 [main] TRACE UserServiceImpl - Entering addRole method in UserServiceImpl
2024-10-25 12:36:29.176 [main] INFO  UserServiceImpl - Adding role 'TECHNICIAN' to user with id '1'
2024-10-25 12:36:29.176 [main] INFO  UserServiceImpl - Successfully sent add role message for user 'existingUser'
2024-10-25 12:36:29.176 [main] INFO  UserServiceImpl - Role 'TECHNICIAN' added successfully to user 'existingUser'
2024-10-25 12:36:29.176 [main] TRACE UserServiceImpl - Exiting addRole method in UserServiceImpl
2024-10-25 12:36:29.208 [main] TRACE UserServiceImpl - Entering deleteUser method in UserServiceImpl
2024-10-25 12:36:29.208 [main] DEBUG UserServiceImpl - Deleting user with id: 1
2024-10-25 12:36:29.208 [main] INFO  UserServiceImpl - Sent delete message to RabbitMQ for user: userToDelete
2024-10-25 12:36:29.208 [main] INFO  UserServiceImpl - User deleted successfully: userToDelete
2024-10-25 12:36:29.208 [main] TRACE UserServiceImpl - Exiting deleteUser method in UserServiceImpl
2024-10-25 12:36:29.208 [main] TRACE UserServiceImpl - Entering createUser method in UserServiceImpl
2024-10-25 12:36:29.208 [main] DEBUG UserServiceImpl - Creating user with username: existingUser
2024-10-25 12:36:29.208 [main] ERROR UserServiceImpl - Username 'existingUser' is already taken
2024-10-25 12:36:29.223 [main] TRACE UserServiceImpl - Entering updateCurrentUser method in UserServiceImpl
2024-10-25 12:36:29.223 [main] INFO  UserServiceImpl - Updating current user: testUser
2024-10-25 12:36:29.223 [main] ERROR UserServiceImpl - User doesn't exist with username: testUser
2024-10-25 12:36:29.223 [main] TRACE UserServiceImpl - Entering getCurrentUser method in UserServiceImpl
2024-10-25 12:36:29.223 [main] INFO  UserServiceImpl - Fetching current user by username: testUser
2024-10-25 12:36:29.223 [main] ERROR UserServiceImpl - User not found with username: testUser
2024-10-25 18:36:10.392 [main] TRACE UserController - Entering addRole method in UserController class
2024-10-25 18:36:10.459 [main] INFO  UserController - Adding role to user with id: 1
2024-10-25 18:36:10.481 [main] INFO  UserController - Role added to user with id 1 successfully
2024-10-25 18:36:10.482 [main] TRACE UserController - Exiting addRole method in UserController class
2024-10-25 18:36:10.720 [main] TRACE UserController - Entering getUsernameByEmail method in UserController class
2024-10-25 18:36:10.726 [main] INFO  UserController - Fetching username by email: test@example.com
2024-10-25 18:36:10.727 [main] TRACE UserController - Exiting getUsernameByEmail method in UserController class
2024-10-25 18:36:10.747 [main] TRACE UserController - Entering getCurrentUser method in UserController class
2024-10-25 18:36:10.747 [main] INFO  UserController - Fetching current user by username: testUser
2024-10-25 18:36:10.748 [main] INFO  UserController - Current user retrieved successfully
2024-10-25 18:36:10.749 [main] TRACE UserController - Exiting getCurrentUser method in UserController class
2024-10-25 18:36:10.771 [main] TRACE UserController - Entering updateUser method in UserController class
2024-10-25 18:36:10.771 [main] INFO  UserController - Updating user with details: UpdateUserRequest(id=null, firstName=null, lastName=null, username=null, email=null, gender=null)
2024-10-25 18:36:10.797 [main] INFO  UserController - User updated successfully
2024-10-25 18:36:10.797 [main] TRACE UserController - Exiting updateUser method in UserController class
2024-10-25 18:36:10.811 [main] TRACE UserController - Entering restoreUser method in UserController class
2024-10-25 18:36:10.811 [main] INFO  UserController - Restoring user with id: 1
2024-10-25 18:36:10.812 [main] INFO  UserController - User with id 1 restored successfully
2024-10-25 18:36:10.812 [main] TRACE UserController - Exiting restoreUser method in UserController class
2024-10-25 18:36:10.828 [main] TRACE UserController - Entering getAllUsersFilteredAndSorted method in UserController class
2024-10-25 18:36:10.828 [main] INFO  UserController - Fetching users with filters - page: 0, size: 3, sortBy: id, direction: ASC, firstName: null, lastName: null, username: null, hospitalId: null, email: null, role: null, gender: null, deleted: null
2024-10-25 18:36:10.829 [main] INFO  UserController - Users filtered and sorted fetched successfully
2024-10-25 18:36:10.829 [main] TRACE UserController - Exiting getAllUsersFilteredAndSorted method in UserController class
2024-10-25 18:36:10.838 [main] TRACE UserController - Entering removeRole method in UserController class
2024-10-25 18:36:10.838 [main] INFO  UserController - Removing role from user with id: 1
2024-10-25 18:36:10.841 [main] INFO  UserController - Role removed from user with id 1 successfully
2024-10-25 18:36:10.842 [main] TRACE UserController - Exiting removeRole method in UserController class
2024-10-25 18:36:10.853 [main] TRACE UserController - Entering createUser method in UserController class
2024-10-25 18:36:10.853 [main] INFO  UserController - Creating a new user with details: CreateUserRequest(firstName=null, lastName=null, username=null, email=null, password=null, roles=null, gender=null)
2024-10-25 18:36:10.864 [main] INFO  UserController - User created successfully
2024-10-25 18:36:10.864 [main] TRACE UserController - Exiting createUser method in UserController class
2024-10-25 18:36:10.877 [main] TRACE UserController - Entering deleteUser method in UserController class
2024-10-25 18:36:10.877 [main] INFO  UserController - Deleting user with id: 1
2024-10-25 18:36:10.878 [main] INFO  UserController - User with id 1 deleted successfully
2024-10-25 18:36:10.878 [main] TRACE UserController - Exiting deleteUser method in UserController class
2024-10-25 18:36:10.887 [main] TRACE UserController - Entering getUserById method in UserController class
2024-10-25 18:36:10.887 [main] INFO  UserController - Fetching user by id: 1
2024-10-25 18:36:10.888 [main] INFO  UserController - User with id 1 retrieved successfully
2024-10-25 18:36:10.889 [main] TRACE UserController - Exiting getUserById method in UserController class
2024-10-25 18:36:10.896 [main] TRACE UserController - Entering updateCurrentUser method in UserController class
2024-10-25 18:36:10.896 [main] INFO  UserController - Updating current user with username: testUser
2024-10-25 18:36:10.897 [main] INFO  UserController - Current user updated successfully
2024-10-25 18:36:10.897 [main] TRACE UserController - Exiting updateCurrentUser method in UserController class
2024-10-25 18:36:12.906 [main] TRACE UserServiceImpl - Entering updateCurrentUser method in UserServiceImpl
2024-10-25 18:36:12.906 [main] INFO  UserServiceImpl - Updating current user: testUser
2024-10-25 18:36:12.909 [main] DEBUG UserServiceImpl - Updated first name for user: com.lab.backend.usermanagement.entity.User@328e687e
2024-10-25 18:36:12.910 [main] DEBUG UserServiceImpl - Saved updated user: com.lab.backend.usermanagement.entity.User@328e687e
2024-10-25 18:36:12.910 [main] TRACE UserServiceImpl - Exiting updateCurrentUser method in UserServiceImpl
2024-10-25 18:36:12.945 [main] TRACE UserServiceImpl - Entering getAllUsersFilteredAndSorted method in UserServiceImpl
2024-10-25 18:36:12.945 [main] INFO  UserServiceImpl - Fetching users with filters: page=0, size=10, sortBy=username, direction=ASC
2024-10-25 18:36:12.975 [main] DEBUG UserServiceImpl - Fetched 1 users
2024-10-25 18:36:12.975 [main] TRACE UserServiceImpl - Exiting getAllUsersFilteredAndSorted method in UserServiceImpl
2024-10-25 18:36:13.009 [main] TRACE UserServiceImpl - Entering updateUser method in UserServiceImpl
2024-10-25 18:36:13.009 [main] DEBUG UserServiceImpl - Updating user with id: 1
2024-10-25 18:36:13.009 [main] ERROR UserServiceImpl - User doesn't exist with id 1
2024-10-25 18:36:13.026 [main] TRACE UserServiceImpl - Entering createUser method in UserServiceImpl
2024-10-25 18:36:13.026 [main] DEBUG UserServiceImpl - Creating user with username: newUser
2024-10-25 18:36:13.059 [main] INFO  UserServiceImpl - Sent create message to RabbitMQ for user: newUser
2024-10-25 18:36:13.064 [main] INFO  UserServiceImpl - User created successfully: newUser
2024-10-25 18:36:13.064 [main] TRACE UserServiceImpl - Exiting createUser method in UserServiceImpl
2024-10-25 18:36:13.076 [main] TRACE UserServiceImpl - Entering getUsernameByEmail method in UserServiceImpl
2024-10-25 18:36:13.077 [main] INFO  UserServiceImpl - Fetching username by email: test@example.com
2024-10-25 18:36:13.077 [main] DEBUG UserServiceImpl - Found username: testUser
2024-10-25 18:36:13.078 [main] TRACE UserServiceImpl - Exiting getUsernameByEmail method in UserServiceImpl
2024-10-25 18:36:13.086 [main] TRACE UserServiceImpl - Entering createUser method in UserServiceImpl
2024-10-25 18:36:13.086 [main] DEBUG UserServiceImpl - Creating user with username: null
2024-10-25 18:36:13.086 [main] ERROR UserServiceImpl - Email 'existingEmail@example.com' is already taken
2024-10-25 18:36:13.105 [main] TRACE UserServiceImpl - Entering getUserById method in UserServiceImpl
2024-10-25 18:36:13.105 [main] INFO  UserServiceImpl - Fetching user by ID: 1
2024-10-25 18:36:13.105 [main] DEBUG UserServiceImpl - Fetched user: GetUserResponse(id=null, firstName=null, lastName=null, username=testUser, hospitalId=null, email=null, roles=null, gender=null)
2024-10-25 18:36:13.117 [main] TRACE UserServiceImpl - Exiting getUserById method in UserServiceImpl
2024-10-25 18:36:13.125 [main] TRACE UserServiceImpl - Entering getCurrentUser method in UserServiceImpl
2024-10-25 18:36:13.125 [main] INFO  UserServiceImpl - Fetching current user by username: testUser
2024-10-25 18:36:13.125 [main] DEBUG UserServiceImpl - Fetched current user: GetUserResponse(id=null, firstName=null, lastName=null, username=testUser, hospitalId=null, email=null, roles=null, gender=null)
2024-10-25 18:36:13.133 [main] TRACE UserServiceImpl - Exiting getCurrentUser method in UserServiceImpl
2024-10-25 18:36:13.145 [main] TRACE UserServiceImpl - Entering updateUser method in UserServiceImpl
2024-10-25 18:36:13.145 [main] DEBUG UserServiceImpl - Updating user with id: null
2024-10-25 18:36:13.145 [main] ERROR UserServiceImpl - Id must not be null
2024-10-25 18:36:13.157 [main] TRACE UserServiceImpl - Entering restoreUser method in UserServiceImpl
2024-10-25 18:36:13.157 [main] DEBUG UserServiceImpl - Restoring user with id: 1
2024-10-25 18:36:13.157 [main] INFO  UserServiceImpl - Sent restore message to RabbitMQ for user: userToRestore
2024-10-25 18:36:13.157 [main] INFO  UserServiceImpl - User restored successfully: userToRestore
2024-10-25 18:36:13.157 [main] TRACE UserServiceImpl - Exiting restoreUser method in UserServiceImpl
2024-10-25 18:36:13.177 [main] TRACE UserServiceImpl - Entering getUserById method in UserServiceImpl
2024-10-25 18:36:13.177 [main] INFO  UserServiceImpl - Fetching user by ID: 1
2024-10-25 18:36:13.177 [main] ERROR UserServiceImpl - User not found with ID: 1
2024-10-25 18:36:13.195 [main] TRACE UserServiceImpl - Entering updateUser method in UserServiceImpl
2024-10-25 18:36:13.196 [main] DEBUG UserServiceImpl - Updating user with id: 1
2024-10-25 18:36:13.196 [main] ERROR UserServiceImpl - Email is already taken newEmail@example.com
2024-10-25 18:36:13.209 [main] TRACE UserServiceImpl - Entering removeRole method in UserServiceImpl
2024-10-25 18:36:13.210 [main] INFO  UserServiceImpl - Removing role 'ADMIN' from user with id '1'
2024-10-25 18:36:13.214 [main] INFO  UserServiceImpl - Successfully sent remove role message for user 'existingUser'
2024-10-25 18:36:13.215 [main] INFO  UserServiceImpl - Role 'ADMIN' removed successfully from user 'existingUser'
2024-10-25 18:36:13.215 [main] TRACE UserServiceImpl - Exiting removeRole method in UserServiceImpl
2024-10-25 18:36:13.226 [main] TRACE UserServiceImpl - Entering addRole method in UserServiceImpl
2024-10-25 18:36:13.226 [main] INFO  UserServiceImpl - Adding role 'ADMIN' to user with id '1'
2024-10-25 18:36:13.226 [main] ERROR UserServiceImpl - User not found with id '1'
2024-10-25 18:36:13.243 [main] TRACE UserServiceImpl - Entering addRole method in UserServiceImpl
2024-10-25 18:36:13.243 [main] INFO  UserServiceImpl - Adding role 'ADMIN' to user with id '1'
2024-10-25 18:36:13.243 [main] ERROR UserServiceImpl - User 'existingUser' already has this role: 'ADMIN'
2024-10-25 18:36:13.245 [main] TRACE UserServiceImpl - Entering removeRole method in UserServiceImpl
2024-10-25 18:36:13.250 [main] INFO  UserServiceImpl - Removing role 'ADMIN' from user with id '1'
2024-10-25 18:36:13.251 [main] ERROR UserServiceImpl - Cannot remove role. User 'existingUser' must have at least one role
2024-10-25 18:36:13.258 [main] TRACE UserServiceImpl - Entering removeRole method in UserServiceImpl
2024-10-25 18:36:13.264 [main] INFO  UserServiceImpl - Removing role 'ADMIN' from user with id '1'
2024-10-25 18:36:13.264 [main] ERROR UserServiceImpl - User not found with id: '1'
2024-10-25 18:36:13.275 [main] TRACE UserServiceImpl - Entering restoreUser method in UserServiceImpl
2024-10-25 18:36:13.276 [main] DEBUG UserServiceImpl - Restoring user with id: 1
2024-10-25 18:36:13.276 [main] ERROR UserServiceImpl - User does not exist with id 1
2024-10-25 18:36:13.284 [main] TRACE UserServiceImpl - Entering getUsernameByEmail method in UserServiceImpl
2024-10-25 18:36:13.285 [main] INFO  UserServiceImpl - Fetching username by email: test@example.com
2024-10-25 18:36:13.287 [main] ERROR UserServiceImpl - No users registered to this email address: test@example.com
2024-10-25 18:36:13.296 [main] TRACE UserServiceImpl - Entering updateUser method in UserServiceImpl
2024-10-25 18:36:13.296 [main] DEBUG UserServiceImpl - Updating user with id: 1
2024-10-25 18:36:13.296 [main] ERROR UserServiceImpl - Username is taken newUsername
2024-10-25 18:36:13.314 [main] TRACE UserServiceImpl - Entering deleteUser method in UserServiceImpl
2024-10-25 18:36:13.315 [main] DEBUG UserServiceImpl - Deleting user with id: 1
2024-10-25 18:36:13.318 [main] ERROR UserServiceImpl - User doesn't exist with id: 1
2024-10-25 18:36:13.325 [main] TRACE UserServiceImpl - Entering addRole method in UserServiceImpl
2024-10-25 18:36:13.325 [main] INFO  UserServiceImpl - Adding role 'TECHNICIAN' to user with id '1'
2024-10-25 18:36:13.325 [main] INFO  UserServiceImpl - Successfully sent add role message for user 'existingUser'
2024-10-25 18:36:13.325 [main] INFO  UserServiceImpl - Role 'TECHNICIAN' added successfully to user 'existingUser'
2024-10-25 18:36:13.325 [main] TRACE UserServiceImpl - Exiting addRole method in UserServiceImpl
2024-10-25 18:36:13.350 [main] TRACE UserServiceImpl - Entering deleteUser method in UserServiceImpl
2024-10-25 18:36:13.352 [main] DEBUG UserServiceImpl - Deleting user with id: 1
2024-10-25 18:36:13.358 [main] INFO  UserServiceImpl - Sent delete message to RabbitMQ for user: userToDelete
2024-10-25 18:36:13.361 [main] INFO  UserServiceImpl - User deleted successfully: userToDelete
2024-10-25 18:36:13.361 [main] TRACE UserServiceImpl - Exiting deleteUser method in UserServiceImpl
2024-10-25 18:36:13.379 [main] TRACE UserServiceImpl - Entering createUser method in UserServiceImpl
2024-10-25 18:36:13.379 [main] DEBUG UserServiceImpl - Creating user with username: existingUser
2024-10-25 18:36:13.379 [main] ERROR UserServiceImpl - Username 'existingUser' is already taken
2024-10-25 18:36:13.393 [main] TRACE UserServiceImpl - Entering updateCurrentUser method in UserServiceImpl
2024-10-25 18:36:13.393 [main] INFO  UserServiceImpl - Updating current user: testUser
2024-10-25 18:36:13.395 [main] ERROR UserServiceImpl - User doesn't exist with username: testUser
2024-10-25 18:36:13.414 [main] TRACE UserServiceImpl - Entering getCurrentUser method in UserServiceImpl
2024-10-25 18:36:13.414 [main] INFO  UserServiceImpl - Fetching current user by username: testUser
2024-10-25 18:36:13.415 [main] ERROR UserServiceImpl - User not found with username: testUser
2024-10-25 21:10:55.167 [main] TRACE UserController - Entering addRole method in UserController class
2024-10-25 21:10:55.183 [main] INFO  UserController - Adding role to user with id: 1
2024-10-25 21:10:55.183 [main] INFO  UserController - Role added to user with id 1 successfully
2024-10-25 21:10:55.183 [main] TRACE UserController - Exiting addRole method in UserController class
2024-10-25 21:10:55.308 [main] TRACE UserController - Entering getUsernameByEmail method in UserController class
2024-10-25 21:10:55.308 [main] INFO  UserController - Fetching username by email: test@example.com
2024-10-25 21:10:55.308 [main] TRACE UserController - Exiting getUsernameByEmail method in UserController class
2024-10-25 21:10:55.308 [main] TRACE UserController - Entering getCurrentUser method in UserController class
2024-10-25 21:10:55.308 [main] INFO  UserController - Fetching current user by username: testUser
2024-10-25 21:10:55.308 [main] INFO  UserController - Current user retrieved successfully
2024-10-25 21:10:55.308 [main] TRACE UserController - Exiting getCurrentUser method in UserController class
2024-10-25 21:10:55.324 [main] TRACE UserController - Entering updateUser method in UserController class
2024-10-25 21:10:55.324 [main] INFO  UserController - Updating user with details: UpdateUserRequest(id=null, firstName=null, lastName=null, username=null, email=null, gender=null)
2024-10-25 21:10:55.324 [main] INFO  UserController - User updated successfully
2024-10-25 21:10:55.324 [main] TRACE UserController - Exiting updateUser method in UserController class
2024-10-25 21:10:55.324 [main] TRACE UserController - Entering restoreUser method in UserController class
2024-10-25 21:10:55.339 [main] INFO  UserController - Restoring user with id: 1
2024-10-25 21:10:55.339 [main] INFO  UserController - User with id 1 restored successfully
2024-10-25 21:10:55.339 [main] TRACE UserController - Exiting restoreUser method in UserController class
2024-10-25 21:10:55.339 [main] TRACE UserController - Entering getAllUsersFilteredAndSorted method in UserController class
2024-10-25 21:10:55.339 [main] INFO  UserController - Fetching users with filters - page: 0, size: 3, sortBy: id, direction: ASC, firstName: null, lastName: null, username: null, hospitalId: null, email: null, role: null, gender: null, deleted: null
2024-10-25 21:10:55.339 [main] INFO  UserController - Users filtered and sorted fetched successfully
2024-10-25 21:10:55.339 [main] TRACE UserController - Exiting getAllUsersFilteredAndSorted method in UserController class
2024-10-25 21:10:55.339 [main] TRACE UserController - Entering removeRole method in UserController class
2024-10-25 21:10:55.339 [main] INFO  UserController - Removing role from user with id: 1
2024-10-25 21:10:55.339 [main] INFO  UserController - Role removed from user with id 1 successfully
2024-10-25 21:10:55.339 [main] TRACE UserController - Exiting removeRole method in UserController class
2024-10-25 21:10:55.355 [main] TRACE UserController - Entering createUser method in UserController class
2024-10-25 21:10:55.355 [main] INFO  UserController - Creating a new user with details: CreateUserRequest(firstName=null, lastName=null, username=null, email=null, password=null, roles=null, gender=null)
2024-10-25 21:10:55.355 [main] INFO  UserController - User created successfully
2024-10-25 21:10:55.355 [main] TRACE UserController - Exiting createUser method in UserController class
2024-10-25 21:10:55.355 [main] TRACE UserController - Entering deleteUser method in UserController class
2024-10-25 21:10:55.355 [main] INFO  UserController - Deleting user with id: 1
2024-10-25 21:10:55.355 [main] INFO  UserController - User with id 1 deleted successfully
2024-10-25 21:10:55.355 [main] TRACE UserController - Exiting deleteUser method in UserController class
2024-10-25 21:10:55.371 [main] TRACE UserController - Entering getUserById method in UserController class
2024-10-25 21:10:55.371 [main] INFO  UserController - Fetching user by id: 1
2024-10-25 21:10:55.371 [main] INFO  UserController - User with id 1 retrieved successfully
2024-10-25 21:10:55.371 [main] TRACE UserController - Exiting getUserById method in UserController class
2024-10-25 21:10:55.371 [main] TRACE UserController - Entering updateCurrentUser method in UserController class
2024-10-25 21:10:55.371 [main] INFO  UserController - Updating current user with username: testUser
2024-10-25 21:10:55.371 [main] INFO  UserController - Current user updated successfully
2024-10-25 21:10:55.371 [main] TRACE UserController - Exiting updateCurrentUser method in UserController class
2024-10-25 21:10:56.543 [main] TRACE UserServiceImpl - Entering updateCurrentUser method in UserServiceImpl
2024-10-25 21:10:56.543 [main] INFO  UserServiceImpl - Updating current user: testUser
2024-10-25 21:10:56.543 [main] DEBUG UserServiceImpl - Updated first name for user: com.lab.backend.usermanagement.entity.User@328e687e
2024-10-25 21:10:56.543 [main] DEBUG UserServiceImpl - Saved updated user: com.lab.backend.usermanagement.entity.User@328e687e
2024-10-25 21:10:56.543 [main] TRACE UserServiceImpl - Exiting updateCurrentUser method in UserServiceImpl
2024-10-25 21:10:56.559 [main] TRACE UserServiceImpl - Entering getAllUsersFilteredAndSorted method in UserServiceImpl
2024-10-25 21:10:56.559 [main] INFO  UserServiceImpl - Fetching users with filters: page=0, size=10, sortBy=username, direction=ASC
2024-10-25 21:10:56.575 [main] DEBUG UserServiceImpl - Fetched 1 users
2024-10-25 21:10:56.575 [main] TRACE UserServiceImpl - Exiting getAllUsersFilteredAndSorted method in UserServiceImpl
2024-10-25 21:10:56.591 [main] TRACE UserServiceImpl - Entering updateUser method in UserServiceImpl
2024-10-25 21:10:56.591 [main] DEBUG UserServiceImpl - Updating user with id: 1
2024-10-25 21:10:56.591 [main] ERROR UserServiceImpl - User doesn't exist with id 1
2024-10-25 21:10:56.607 [main] TRACE UserServiceImpl - Entering createUser method in UserServiceImpl
2024-10-25 21:10:56.607 [main] DEBUG UserServiceImpl - Creating user with username: newUser
2024-10-25 21:10:56.622 [main] INFO  UserServiceImpl - Sent create message to RabbitMQ for user: newUser
2024-10-25 21:10:56.622 [main] INFO  UserServiceImpl - User created successfully: newUser
2024-10-25 21:10:56.622 [main] TRACE UserServiceImpl - Exiting createUser method in UserServiceImpl
2024-10-25 21:10:56.639 [main] TRACE UserServiceImpl - Entering getUsernameByEmail method in UserServiceImpl
2024-10-25 21:10:56.639 [main] INFO  UserServiceImpl - Fetching username by email: test@example.com
2024-10-25 21:10:56.639 [main] DEBUG UserServiceImpl - Found username: testUser
2024-10-25 21:10:56.639 [main] TRACE UserServiceImpl - Exiting getUsernameByEmail method in UserServiceImpl
2024-10-25 21:10:56.639 [main] TRACE UserServiceImpl - Entering createUser method in UserServiceImpl
2024-10-25 21:10:56.639 [main] DEBUG UserServiceImpl - Creating user with username: null
2024-10-25 21:10:56.639 [main] ERROR UserServiceImpl - Email 'existingEmail@example.com' is already taken
2024-10-25 21:10:56.655 [main] TRACE UserServiceImpl - Entering getUserById method in UserServiceImpl
2024-10-25 21:10:56.655 [main] INFO  UserServiceImpl - Fetching user by ID: 1
2024-10-25 21:10:56.655 [main] DEBUG UserServiceImpl - Fetched user: GetUserResponse(id=null, firstName=null, lastName=null, username=testUser, hospitalId=null, email=null, roles=null, gender=null)
2024-10-25 21:10:56.655 [main] TRACE UserServiceImpl - Exiting getUserById method in UserServiceImpl
2024-10-25 21:10:56.671 [main] TRACE UserServiceImpl - Entering getCurrentUser method in UserServiceImpl
2024-10-25 21:10:56.671 [main] INFO  UserServiceImpl - Fetching current user by username: testUser
2024-10-25 21:10:56.671 [main] DEBUG UserServiceImpl - Fetched current user: GetUserResponse(id=null, firstName=null, lastName=null, username=testUser, hospitalId=null, email=null, roles=null, gender=null)
2024-10-25 21:10:56.671 [main] TRACE UserServiceImpl - Exiting getCurrentUser method in UserServiceImpl
2024-10-25 21:10:56.671 [main] TRACE UserServiceImpl - Entering updateUser method in UserServiceImpl
2024-10-25 21:10:56.671 [main] DEBUG UserServiceImpl - Updating user with id: null
2024-10-25 21:10:56.671 [main] ERROR UserServiceImpl - Id must not be null
2024-10-25 21:10:56.686 [main] TRACE UserServiceImpl - Entering restoreUser method in UserServiceImpl
2024-10-25 21:10:56.686 [main] DEBUG UserServiceImpl - Restoring user with id: 1
2024-10-25 21:10:56.686 [main] INFO  UserServiceImpl - Sent restore message to RabbitMQ for user: userToRestore
2024-10-25 21:10:56.686 [main] INFO  UserServiceImpl - User restored successfully: userToRestore
2024-10-25 21:10:56.686 [main] TRACE UserServiceImpl - Exiting restoreUser method in UserServiceImpl
2024-10-25 21:10:56.686 [main] TRACE UserServiceImpl - Entering getUserById method in UserServiceImpl
2024-10-25 21:10:56.686 [main] INFO  UserServiceImpl - Fetching user by ID: 1
2024-10-25 21:10:56.686 [main] ERROR UserServiceImpl - User not found with ID: 1
2024-10-25 21:10:56.703 [main] TRACE UserServiceImpl - Entering updateUser method in UserServiceImpl
2024-10-25 21:10:56.703 [main] DEBUG UserServiceImpl - Updating user with id: 1
2024-10-25 21:10:56.703 [main] ERROR UserServiceImpl - Email is already taken newEmail@example.com
2024-10-25 21:10:56.703 [main] TRACE UserServiceImpl - Entering removeRole method in UserServiceImpl
2024-10-25 21:10:56.703 [main] INFO  UserServiceImpl - Removing role 'ADMIN' from user with id '1'
2024-10-25 21:10:56.703 [main] INFO  UserServiceImpl - Successfully sent remove role message for user 'existingUser'
2024-10-25 21:10:56.703 [main] INFO  UserServiceImpl - Role 'ADMIN' removed successfully from user 'existingUser'
2024-10-25 21:10:56.703 [main] TRACE UserServiceImpl - Exiting removeRole method in UserServiceImpl
2024-10-25 21:10:56.719 [main] TRACE UserServiceImpl - Entering addRole method in UserServiceImpl
2024-10-25 21:10:56.719 [main] INFO  UserServiceImpl - Adding role 'ADMIN' to user with id '1'
2024-10-25 21:10:56.719 [main] ERROR UserServiceImpl - User not found with id '1'
2024-10-25 21:10:56.719 [main] TRACE UserServiceImpl - Entering addRole method in UserServiceImpl
2024-10-25 21:10:56.719 [main] INFO  UserServiceImpl - Adding role 'ADMIN' to user with id '1'
2024-10-25 21:10:56.719 [main] ERROR UserServiceImpl - User 'existingUser' already has this role: 'ADMIN'
2024-10-25 21:10:56.736 [main] TRACE UserServiceImpl - Entering removeRole method in UserServiceImpl
2024-10-25 21:10:56.736 [main] INFO  UserServiceImpl - Removing role 'ADMIN' from user with id '1'
2024-10-25 21:10:56.736 [main] ERROR UserServiceImpl - Cannot remove role. User 'existingUser' must have at least one role
2024-10-25 21:10:56.736 [main] TRACE UserServiceImpl - Entering removeRole method in UserServiceImpl
2024-10-25 21:10:56.736 [main] INFO  UserServiceImpl - Removing role 'ADMIN' from user with id '1'
2024-10-25 21:10:56.736 [main] ERROR UserServiceImpl - User not found with id: '1'
2024-10-25 21:10:56.751 [main] TRACE UserServiceImpl - Entering restoreUser method in UserServiceImpl
2024-10-25 21:10:56.751 [main] DEBUG UserServiceImpl - Restoring user with id: 1
2024-10-25 21:10:56.751 [main] ERROR UserServiceImpl - User does not exist with id 1
2024-10-25 21:10:56.751 [main] TRACE UserServiceImpl - Entering getUsernameByEmail method in UserServiceImpl
2024-10-25 21:10:56.751 [main] INFO  UserServiceImpl - Fetching username by email: test@example.com
2024-10-25 21:10:56.751 [main] ERROR UserServiceImpl - No users registered to this email address: test@example.com
2024-10-25 21:10:56.766 [main] TRACE UserServiceImpl - Entering updateUser method in UserServiceImpl
2024-10-25 21:10:56.766 [main] DEBUG UserServiceImpl - Updating user with id: 1
2024-10-25 21:10:56.766 [main] ERROR UserServiceImpl - Username is taken newUsername
2024-10-25 21:10:56.766 [main] TRACE UserServiceImpl - Entering deleteUser method in UserServiceImpl
2024-10-25 21:10:56.766 [main] DEBUG UserServiceImpl - Deleting user with id: 1
2024-10-25 21:10:56.766 [main] ERROR UserServiceImpl - User doesn't exist with id: 1
2024-10-25 21:10:56.766 [main] TRACE UserServiceImpl - Entering addRole method in UserServiceImpl
2024-10-25 21:10:56.766 [main] INFO  UserServiceImpl - Adding role 'TECHNICIAN' to user with id '1'
2024-10-25 21:10:56.782 [main] INFO  UserServiceImpl - Successfully sent add role message for user 'existingUser'
2024-10-25 21:10:56.782 [main] INFO  UserServiceImpl - Role 'TECHNICIAN' added successfully to user 'existingUser'
2024-10-25 21:10:56.782 [main] TRACE UserServiceImpl - Exiting addRole method in UserServiceImpl
2024-10-25 21:10:56.782 [main] TRACE UserServiceImpl - Entering deleteUser method in UserServiceImpl
2024-10-25 21:10:56.782 [main] DEBUG UserServiceImpl - Deleting user with id: 1
2024-10-25 21:10:56.782 [main] INFO  UserServiceImpl - Sent delete message to RabbitMQ for user: userToDelete
2024-10-25 21:10:56.782 [main] INFO  UserServiceImpl - User deleted successfully: userToDelete
2024-10-25 21:10:56.782 [main] TRACE UserServiceImpl - Exiting deleteUser method in UserServiceImpl
2024-10-25 21:10:56.798 [main] TRACE UserServiceImpl - Entering createUser method in UserServiceImpl
2024-10-25 21:10:56.798 [main] DEBUG UserServiceImpl - Creating user with username: existingUser
2024-10-25 21:10:56.798 [main] ERROR UserServiceImpl - Username 'existingUser' is already taken
2024-10-25 21:10:56.798 [main] TRACE UserServiceImpl - Entering updateCurrentUser method in UserServiceImpl
2024-10-25 21:10:56.798 [main] INFO  UserServiceImpl - Updating current user: testUser
2024-10-25 21:10:56.798 [main] ERROR UserServiceImpl - User doesn't exist with username: testUser
2024-10-25 21:10:56.816 [main] TRACE UserServiceImpl - Entering getCurrentUser method in UserServiceImpl
2024-10-25 21:10:56.816 [main] INFO  UserServiceImpl - Fetching current user by username: testUser
2024-10-25 21:10:56.816 [main] ERROR UserServiceImpl - User not found with username: testUser
